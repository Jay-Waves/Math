密码体系有两个准则:
1. Kerchhoff 准则: 安全性不能建立在对算法的保密上.
2. Dolev Yao 准则: 安全协议本身应该与其所具体采用的密码技术分开, 在假定密码技术完善的基础上分析安全协议本身的安全性/正确性/冗余性.

## 安全协议标准

安全协议与一般通信协议的区别是: 有恶意参与者. 安全协议除了协议正确性和效率, 还额外兼顾**安全需求**和**鲁棒性**.

模型组成部分:  
- 参与者类型: 参与者, 攻击者, 可信第三方 (Trusted Third Party), 仲裁者 (Arbiter)
- 参与者间网络连接情况: 同步网络与异步网络, 须考虑时钟周期同步性与消息顺序
- 协议参与者的诚实程度: 诚实参与者, 半诚实参与者 (按协议要求执行, 但监听消息), 恶意攻击者 (不仅监听, 还恶意设计执行方式)
- 协议攻击者的能力 (窃听者, 主动攻击者, 见 [安全模型](obsidian://open?vault=Code&file=Security%2F%E5%AE%89%E5%85%A8%E6%A8%A1%E5%9E%8B))

### 1 安全协议设计步骤

1. 需求分析
2. 需求定义
3. 协议具体步骤设计
4. 协议正确性分析
5. 协议安全性分析

### 2 安全属性

- **认证性**, 授权, autentication
- **机密性**
- **完整性**, 防篡改, integrity
- **非否认性**, non-repudiation
- **公平性**
- **匿名性**, 不泄露发送者身份.
- 前向保密性, forward secrecy
- 新鲜性, freshness
- 可用性, accessability
- 抗重放攻击, anti-replay attack
- 可扩展性, scalability
- 互操作性, interoperability, 与其他协议和软件兼容

### 3 协议安全性分析方法

- 攻击检测方法, 采用已知攻击方法逐个尝试攻击协议.
- 形式化分析理论与方法, 如 [BAN 逻辑](BAN逻辑.md)
- ...[可证明安全性理论与方法](../附录/可证明安全/Provable%20Security.md)

## 安全协议分类

按安全协议的功能分类, 有:
1. 密钥建立协议, Key Establishment Protocol.
	- 密钥传输协议
	- 密钥协商协议
1. 认证协议, Authentication Protocol.
	- [基于加密的认证协议](认证协议/基于加密的认证协议.md)
	- [基于口令的认证协议](认证协议/基于口令的认证协议.md)
1. [认证的密钥建立协议](认证的密钥协商协议/认证密钥协商协议.md), 即与已被认证的实体间建立共享秘密.

***

**设计原则:**

- 消息独立完整性原则: 消息解释应完全由其内容推断, 不必借助上下文. 如序列号消息中应包含收发双方标识.
- 消息前提准确性原则: 推断某消息是否应被接受
- 主体身份标识原则
- 加密目的明确性原则: 秘密性, 完整性, 认证性 目的明确.
- 签名含义清晰性原则: 先加密再签名, 主体可能不知道消息内容.
- 临时值使用原则: 确保时间上连续性, 关联性
- 随机数使用原则
- 时间戳使用原则
- 密钥使用规则: 密钥是否最近已被使用过.

**缺陷分类:**

1. 基本协议缺陷
2. 口令/密钥猜测缺陷
3. 陈旧消息缺陷
4. 并行会话缺陷
5. 内部协议缺陷: 协议可达性存在问题, 参与者可能无法完成所有必需动作.
6. 密码系统缺陷

**攻击方法:**

1. 已知明文攻击
2. 选择密文攻击
3. 预言者会话攻击
4. 并行会话攻击
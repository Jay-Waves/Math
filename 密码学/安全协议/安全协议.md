## 安全协议标准

安全协议与一般通信协议的区别是: 有恶意参与者. 安全协议除了协议正确性和效率, 还额外兼顾**安全需求**和**鲁棒性**.

模型组成部分:  
- 参与者类型: 参与者, 攻击者, 可信第三方 (Trusted Third Party), 仲裁者 (Arbiter)
- 参与者间网络连接情况: 同步网络与异步网络, 须考虑时钟周期同步性与消息顺序
- 协议参与者的诚实程度
- 协议攻击者的能力 (窃听者, 主动攻击者, 见 [安全模型](../概念与标准/安全模型.md))

### 1 参与者诚实程度

- 诚实参与者: 按协议要求执行.
- 半诚实参与者: 按协议要求执行, 但对其他参与者进行监听.
- 恶意攻击者: 不仅窃听, 还恶意设计执行方式.

### 2 安全协议设计步骤

1. 需求分析
2. 需求定义
3. 协议具体步骤设计
4. 协议正确性分析
5. 协议安全性分析

### 3 Dolev-Yao 模型

1983 年 DY 模型:
- 认证协议本身应该与认证协议所具体采用的密码技术分开.
- 为攻击者建立了更强大的模型.

DY 认为攻击者可能控制通信网络, 有如下能力:
1. 转发消息到其意定接收者处
2. 延迟消息的送达
3. 将消息篡改后转发
4. 将消息与以前接收的消息合并
5. 改变部分或全部消息的去处
6. 重放消息

### 4 安全属性

- **认证性**, 授权, autentication
- **机密性**
- **完整性**, 防篡改, integrity
- **非否认性**, non-repudiation
- **公平性**
- **匿名性**, 不泄露发送者身份.
- 前向保密性, forward secrecy
- 新鲜性, freshness
- 可用性, accessability
- 抗重放攻击, anti-replay attack
- 可扩展性, scalability
- 互操作性, interoperability, 与其他协议和软件兼容

### 5 协议安全性分析方法

- [可证明安全性理论与方法](../可证明安全/Provable%20Security.md)
- [形式化分析理论与方法](BAN逻辑.md)
- 混合理论与方法
- 零知识证明理论与方法
- 安全多方计算理论与方法

***

## 安全协议设计原则

- 消息独立完整性原则: 消息解释应完全由其内容推断, 不必借助上下文. 如序列号消息中应包含收发双方标识.
- 消息前提准确性原则: 推断某消息是否应被接受
- 主体身份标识原则
- 加密目的明确性原则: 秘密性, 完整性, 认证性 目的明确.
- 签名含义清晰性原则: 先加密再签名, 主体可能不知道消息内容.
- 临时值使用原则: 确保时间上连续性, 关联性
- 随机数使用原则
- 时间戳使用原则
- 密钥使用规则: 密钥是否最近已被使用过.

## 安全协议缺陷分类

1. 基本协议缺陷
2. 口令/密钥猜测缺陷
3. 陈旧消息缺陷
4. 并行会话缺陷
5. 内部协议缺陷: 协议可达性存在问题, 参与者可能无法完成所有必需动作.
6. 密码系统缺陷